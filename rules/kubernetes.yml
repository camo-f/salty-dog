rules:
  - name: kubernetes-require-resources
    level: info
    tags:
      - cluster-health
      - important

    nodes:
      select: '$.spec.template.spec.containers[*]'

    schema:
      type: object
      additionalProperties: true
      required: [resources]
      properties:
        resources:
          type: object
          required: [limits, requests]
          properties:
            limits:
              type: object
              required: [cpu, memory]
              properties:
                cpu:
                  type: string
                memory:
                  type: string
            requests:
              type: object
              required: [cpu, memory]
              properties:
                cpu:
                  type: string
                memory:
                  type: string